import{c as b}from"./api.yQKbUgAA.js";document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("register-form"),a=document.getElementById("error-message"),v=document.getElementById("error-text"),i=document.getElementById("success-message"),E=document.getElementById("success-text"),d=document.getElementById("register-button"),c=document.getElementById("register-text"),l=document.getElementById("register-loading");function s(o){v.textContent=o,a.classList.remove("hidden"),i.classList.add("hidden")}function L(o){E.textContent=o,i.classList.remove("hidden"),a.classList.add("hidden")}function h(){a.classList.add("hidden"),i.classList.add("hidden")}function m(o){o?(c.classList.add("hidden"),l.classList.remove("hidden"),d.disabled=!0):(c.classList.remove("hidden"),l.classList.add("hidden"),d.disabled=!1)}function p(o,r){return o!==r?"Las contraseñas no coinciden":o.length<6?"La contraseña debe tener al menos 6 caracteres":null}n.addEventListener("submit",async o=>{o.preventDefault(),h();const r=new FormData(n),x=r.get("nombre"),w=r.get("email"),g=r.get("password"),y=r.get("confirm-password"),u=p(g,y);if(u){s(u);return}m(!0);try{console.log("Preparando datos de usuario para registro");const e=x.trim().split(" "),D=e[0]||"",P=e.slice(1).join(" ")||"",f={email:w,password:g,first_name:D};console.log("Datos de usuario preparados:",{...f,password:"***OCULTA***"}),console.log("Llamando a createDirectusUser");const t=await b(f);console.log("Resultado de createDirectusUser:",t),t&&t.success?(console.log("Registro exitoso, mostrando mensaje de éxito"),L("Cuenta creada exitosamente. Redirigiendo al login..."),n.reset(),console.log("Formulario limpiado"),console.log("Configurando redirección a login"),setTimeout(()=>{console.log("Redirigiendo a login"),window.location.href="/login"},2e3)):(console.error("Error en createUsuario:",t?.error||"Resultado desconocido"),s(t?.error||"Error al crear la cuenta. Por favor, intenta de nuevo."))}catch(e){console.error("Error durante el registro:",e),console.error("Detalles del error:",{mensaje:e.message,nombre:e.name,código:e.code,stack:e.stack}),e.message&&(e.message.includes("email")||e.message.includes("duplicate"))?(console.log("Error detectado: Email ya registrado"),s("Este email ya está registrado. Por favor, usa otro email.")):e.message&&e.message.includes("validation")?(console.log("Error detectado: Datos inválidos"),s("Datos inválidos. Por favor, verifica la información.")):e.message&&e.message.includes("timeout")?(console.log("Error detectado: Timeout"),s("El servidor tardó demasiado en responder. Por favor, intenta de nuevo.")):e.message&&e.message.includes("network")?(console.log("Error detectado: Problema de red"),s("Problema de conexión a internet. Por favor, verifica tu conexión e intenta de nuevo.")):(console.log("Error general de conexión"),s("Error de conexión. Por favor, intenta de nuevo."))}finally{m(!1)}})});
